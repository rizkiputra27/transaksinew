<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Beranda Transaksi</title>
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/xlsx.mini.min.js"></script>
  <link rel="stylesheet" href="style.css"></style>
</head>
<body>
  <div class="container">
    <h1>üìä Beranda Catatan Transaksi</h1>
    <h1>ADG CELL</h1>
    <div class="link-group">
      <a href="pulsa.html">üì± Penjualan Pulsa</a>
      <a href="tf.html">üè¶ Transfer Bank</a>
      <a href="tartun.html">üíµ Tarik Tunai</a>
      <a href="servis.html">Servis</a>
      <a href="backup.html">üè¶ Ekspor Excel</a>

    </div>
  </div>
<script>
function exportToExcel() {
  const wb = XLSX.utils.book_new();

  const pulsaWS = XLSX.utils.table_to_sheet(document.getElementById('pulsaTable'));
  const tfWS = XLSX.utils.table_to_sheet(document.getElementById('tfTable'));
  const tarikWS = XLSX.utils.table_to_sheet(document.getElementById('tarikTable'));

  XLSX.utils.book_append_sheet(wb, pulsaWS, 'Pulsa');
  XLSX.utils.book_append_sheet(wb, tfWS, 'Transfer');
  XLSX.utils.book_append_sheet(wb, tarikWS, 'TarikTunai');

  XLSX.writeFile(wb, 'Laporan_Transaksi_ADG.xlsx');
}
const CURRENT_VERSION = "1.0.3"; // versi lokal halaman

  async function checkForUpdate() {
    try {
      const res = await fetch('version.json', { cache: "no-cache" });
      const data = await res.json();
      if (data.version !== CURRENT_VERSION) {
        if (confirm("Versi baru tersedia. Klik OK untuk memuat ulang.")) {
          location.reload(true);
        }
      }
    } catch (err) {
      console.error("Gagal cek versi:", err);
    }
  }

  // Cek update setiap 60 detik
  setInterval(checkForUpdate, 60000);
</script>

</body>
</html>
